{
  "Severity": "HIGH",
  "UpdatedAt": "2025-04-18T15:02:45Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "fastify"
  },
  "Advisory": {
    "DatabaseId": 290899,
    "Id": "GSA_kwCzR0hTQS1tZzJoLTZ4NjItd3B3Y84ABHBT",
    "GhsaId": "GHSA-mg2h-6x62-wpwc",
    "References": [
      {
        "Url": "https://github.com/fastify/fastify/security/advisories/GHSA-mg2h-6x62-wpwc"
      },
      {
        "Url": "https://github.com/fastify/fastify/commit/436da4c06dfbbb8c24adee3a64de0c51e4f47418"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2025-32442"
      },
      {
        "Url": "https://hackerone.com/reports/3087928"
      },
      {
        "Url": "https://github.com/advisories/GHSA-mg2h-6x62-wpwc"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-mg2h-6x62-wpwc"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2025-32442"
      }
    ],
    "Description": "### Impact\n\nIn applications that specify different validation strategies for different content types, it's possible to bypass the validation by providing a _slightly altered_ content type such as with different casing or altered whitespacing before `;`.\n\nUsers using the the following pattern are affected:\n\n```js\nfastify.post('/', {\n  handler(request, reply) {\n    reply.code(200).send(request.body)\n  },\n  schema: {\n    body: {\n      content: {\n        'application/json': {\n          schema: {\n            type: 'object',\n            properties: {\n              'foo': {\n                type: 'string',\n              }\n            },\n            required: ['foo']\n          }\n        },\n      }\n    }\n  }\n})\n```\n\nUser using the following pattern are **not** affected:\n\n```js\nfastify.post('/', {\n  handler(request, reply) {\n    reply.code(200).send(request.body)\n  },\n  schema: {\n    body: {\n      type: 'object',\n      properties: {\n        'foo': {\n          type: 'string',\n        }\n      },\n      required: ['foo']\n    }\n  }\n})\n```\n\n### Patches\n_Has the problem been patched? What versions should users upgrade to?_\n\n### Workarounds\n\nDo not specify individual content types in the schema.\n\n### References\n_Are there any links users can visit to find out more?_\n\nhttps://hackerone.com/reports/3087928",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2025-04-18T15:02:41Z",
    "Severity": "HIGH",
    "Summary": "Fastify vulnerable to invalid content-type parsing, which could lead to validation bypass",
    "UpdatedAt": "2025-04-18T18:34:36Z",
    "WithdrawnAt": "",
    "CVSS": {
      "Score": 7.5,
      "VectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N"
    }
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "5.3.1"
      },
      "VulnerableVersionRange": "\u003e= 5.0.0, \u003c= 5.3.0"
    }
  ]
}